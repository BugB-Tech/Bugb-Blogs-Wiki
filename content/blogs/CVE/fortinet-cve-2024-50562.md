---

title: "Breaking Sessions: The Story of CVE-2024-50562 in Fortinet Web Client"
slug: "cve-2024-50562-fortinet-session-hijack"
date: "2025-06-10"
author: "BugB Security Team"
authorTitle: "Security Researchers"
excerpt: "Explore how an AI-driven red team assessment led to the discovery of CVE-2024-50562—a critical session management flaw in Fortinet's Web Client that enabled persistent session hijacking."
category: "research"
--------------------

# Breaking Sessions: The Story of CVE-2024-50562 in Fortinet Web Client

## Summary

An **Insufficient Session Expiration** vulnerability \[CWE-613] in FortiOS SSL-VPN may allow an attacker in possession of a valid VPN cookie to reuse it after logout or natural expiration, gaining unauthorized access to the SSL-VPN portal.

## Affected Versions & Solutions

| Version            | Affected Versions    | Solution                                      |
| ------------------ | -------------------- | --------------------------------------------- |
| **FortiOS 7.6**    | 7.6.0                | Upgrade to **7.6.1 or above**                 |
| **FortiOS 7.4**    | 7.4.0 through 7.4.7  | Upgrade to **7.4.8 or above**                 |
| **FortiOS 7.2**    | 7.2.0 through 7.2.10 | Upgrade to **7.2.11 or above**                |
| **FortiOS 7.0**    | All 7.0.x versions   | Migrate to a fixed release                    |
| **FortiOS 6.4**    | All 6.4.x versions   | Migrate to a fixed release                    |
| **FortiSASE 24.4** | 24.4.b               | Remediated in **24.4.c** – no action required |

> **Note:** Tunnel mode is **not** affected by this issue.

Follow the recommended upgrade path using our tool: [https://docs.fortinet.com/upgrade-tool](https://docs.fortinet.com/upgrade-tool)

## What Is CVE-2024-50562?

CVE-2024-50562 is a critical vulnerability in Fortinet’s Web-based VPN client (FortiOS v7.2.8 and prior), where session tokens are never invalidated server-side. Even after logout or expiration, those cookies can be replayed to regain full user access.

### CVSS Severity: 9.4 (Critical)

## Discovery Context

During a red team engagement with Scribetech, our AI-driven offensive framework **Cert-X-Gen** observed:

* Persistent session cookies post-logout
* Successful replay of stale tokens without triggering 401 errors
* Absent server-side expiry or revocation checks

Further testing confirmed a full session hijack was possible with no valid credentials.

## Attack Flow Breakdown

1. **Intercept a Valid Session Cookie** (e.g., via Burp Suite)
2. **Allow the User to Logout or Wait for Expiry**
3. **Replay the Old Cookie** in a new request
4. **Access Restored** – the VPN portal grants full access without prompting for credentials

#### Proof of Concept (Simplified)

```http
POST /remote/logincheck HTTP/1.1
Host: <fortinet-vpn>
Cookie: SVPNCOOKIE=<stale_token>
```

No 401 or invalidation—access persists.

## YAML Detection Template

```yaml
id: cve-2024-50562

info:
  name: Fortinet Web Client Session Hijacking
  author: BugB Security Team
  severity: critical
  description: >
    Fortinet's Web Client (FortiOS v7.2.8 and prior) fails to invalidate session tokens
    upon logout or expiration, allowing unauthorized reuse and session hijacking.
  tags:
    - session-hijack
    - fortinet
    - vpn
    - authentication-bypass
    - ai-discovered
    - cert-x-gen
  reference:
    - https://fortiguard.com/psirt/FG-IR-24-339
    - https://bugb.io/cve-2024-50562
    - https://nvd.nist.gov/vuln/detail/CVE-2024-50562

requests:
  - method: GET
    path:
      - "/remote/login?lang=en"
    matchers:
      - type: status
        status: 
          - 200
      - type: word
        words: 
          - "Fortinet"
          - "VPN"
        condition: and

  - method: POST
    path:
      - "/remote/logincheck"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
    body: "ajax=1&username=test&credential=wrongpass"
    matchers:
      - type: regex
        regex:
          - "redir=.*?hostcheck_install"
        part: body
      - type: word
        words: 
          - "Set-Cookie"
        part: header
    extractors:
      - type: regex
        name: session_cookie
        part: header
        regex:
          - "SVPNCOOKIE=([^;]+);"

  - method: GET
    path:
      - "/remote/hostcheck_install"
    headers:
      Cookie: "SVPNCOOKIE={{session_cookie}}"
    matchers:
      - type: status
        status: 
          - 200
      - type: word
        words: 
          - "Welcome"
          - "SSL VPN"
        condition: or
```

## Role of Cert-X-Gen

Our AI agent combines:

* **Behavioral Fingerprinting** of Fortinet portals
* **Automated Login/Logout Workflows**
* **Cookie Replay Testing**
* **State-Inconsistency Flagging**

It simulates real-world attacker behavior—intelligent adversarial testing, not just passive scanning.

## Timeline

* **March 2025:** Discovery during Scribetech engagement
* **April 2025:** PoC developed and responsibly disclosed to Fortinet PSIRT
* **May 2025:** Fortinet assigns CVE-2024-50562 and prepares advisory
* **June 10, 2025:** PSIRT advisory published (initial publication)

## Acknowledgements

Fortinet thanks **Vang3lis** and **Cyth** from VARAS\@IIE, and **Shahid Parvez Hakim**, CEO & Founder of BugB Technologies (bugb.io), for their responsible disclosure and collaboration.

## Recommended Fixes

* **Upgrade** to fixed releases per the table above (use Fortinet Upgrade Tool)
* **Invalidate** all session tokens immediately upon logout or expiration
* **Implement Strict Expiry Checks** server-side on every request
* **Rotate** tokens on each login and critical actions
* **Monitor & Alert** on any replayed or reused tokens via anomaly detection

---

*CVE-2024-50562 reminds us: session management is your frontline. With AI-led adversarial testing from Cert-X-Gen, you get proactive defense—patch today before an attacker tests your sessions for you.*
